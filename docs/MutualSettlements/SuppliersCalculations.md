# Расчеты с поставщиками (архитектура)

Расчеты с поставщиками в системе сделаны так, что при каждом изменении расчетов запускается перераспределения денежных средств  

Если объект по соглашению расчет по накладным и в документе объект расчета - конкретное поступление товаров и услуг, то данный документ в перераспределении не участвует

Каждый документ, который участвует в расчетах с поставщиками записывается в регистр **Расчеты с поставщиками** (к2РасчетыСПоставщиками)

Для документов, участвующих в распределении, также идет запись в регистр **Расчеты с поставщиками по срокам** (к2РасчетыСПоставщикамиПоСрокам)  
Регистратором этого регистра является технический документ **Регистратор расчетов** (к2РегистраторРасчетов)    
Для быстродействия для каждого объектра расчета создается новый Регистратор документов, когда записей в нем становится больше 500. Подсчет записей происходит в регистре **Количество записей регистраторов расчетов** (к2КоличествоЗаписейРегистраторовРасчетов)  
Для соглашения с расчетом по соглашениям такой документ один на все время (пока не превышено количество записей). Для соглашений с расчетом по накладным для каждого поступления создается свой документ Регистратор расчетов (для каждого поступления новый регистратор)  

Также, каждый документ, который участвует в расчетах с поставщиками записывается в регистр **Вспомогательная информация взаиморасчетов** (к2ВспомогательнаяИнформацияВзаиморасчетов). Он нужен для правильного распределения денежных средств    
В нем порядок операции - дата платежа (если есть) или дата документа, дата операции - дата планового погашения или дата платежа

При проведении документа, участвующего в распределении, происходит перераспределение всех документов, которые он затрагивает по объекту расчетов  

Документы, которые уменьшают задолженность, берут документы, которые меньше его по дате платежа, и оплачивают их по дате операции (начиная с самой ранней)  
В регистр **Расчеты с поставщиками** при проведении документа Прихода сразу идет правильная запись, т.е. в объект расчета записывается оплачиваемый объект. Таким образом регистр закрывается